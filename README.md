This repository contains simulation files and data used in the [study](https://www.biorxiv.org/content/10.1101/2025.08.27.672390v1) - **Biomolecular phase boundaries are described by a solubility product that accounts for variable stoichiometry and soluble oligomers**

- We used the [SpringSaLaD software](https://vcell.org/ssalad) platform to run Langevin dynamics simulations. _SIM.txt files exemplify input files generated by the software. SpringSaLaD has a convenient GUI to visualize the model components. One can also use these [notebooks](https://github.com/SpringSaLaDpy/SpringSaLaDpy_demo/blob/main/Examples/analysis(Nephrin-Nck-NWasp).ipynb) to inspect the model in greater details. The input file contains information about
  - Simulation time (Time information: Total time - simulation time, dt - timestep, dt_spring - relaxation time for harmonic bonds, dt_data - interval for saving clustering state, dt_image - interval for saving movies)
    
  - Simulation box size (System information: L_x, L_y, L_z: length of the box along three directions. _in and _out are irrelevant for our case. This is a placeholder for multiple compartments. Partition (Nx, Ny, Nz) counts are used to divide the box into subvolumes and binding partner search is conducted within each subvolume to reduce the computational cost. Length unit is shown in um; Lx = Ly = Lz = 120 nm)
    
  - Structure of the molecules (location and connectivity - number of sites and sitetypes; A, B = stickers; L_a, L_b = linkers or spacers)
    
  - Variables to compute during simulation (diverse "Counters" commands)
    
  - Binding Reaction
  -     'A_B_binding'       'poly_B' : 'B' : 'State0'  +  'poly_A' : 'A' : 'State0'  kon 10.0  koff 3500.0  Bond_Length 0.5
  - A-type can bind to B-type with pre-defined on and off rate. The ratio is the binding affinity (Kd = k_off/k_on). These rates are (experimentally measurable) macroscopic parameters which are converted to microscopic probabilities by the software. See [Michalski and Loew 2016](https://pmc.ncbi.nlm.nih.gov/articles/PMC4744174/) for details. Once the beads are bonded, the distance between the surfaces is given by the "Bond_Length" parameter (0.5 nm)
    
  - Clusters are computed from the topology/connectivity of the system in a graph-based approach. See methods in [Chattaraj & Loew 2023](https://github.com/achattaraj/maximal_Solubility_product/tree/main/springsalad) and [SpringSaLaDPy](https://github.com/SpringSaLaDpy/SpringSaLaDpy_demo)
    
  - In this work, we run 25 stochastic runs in parallel for each condition. Once the system converges to a steady state, we sample multiple points from each trajectory across runs to get statistically robust behavior.  

- Representative input files are provided for four systems with different valencies used in this study. A8_B8_count_15_15_SIM.txt refers to input file containing 15 molecules of octavalent A and B. Similarly, other files represent A9_B7, A10_B6, A12_B4 respectively. 


<p align="center">
  <img src="https://github.com/achattaraj/softSP_theory/blob/main/Chain_summary.jpg" alt="Molecular structure" width="600" height="600" >
</p>


- Inter-sticker binding affinity = 350 ÂµM, as measured in [Li et al. 2012](https://pmc.ncbi.nlm.nih.gov/articles/PMC3343696/) 

- The folder "Simulation data" contains results for 4 systems. For each system, 64 concentration points are analyzed.
  
- The folder "example_dataset" shows two examples containing all 25 stochastic runs for each condition. 

- Similar analysis can be found in previous papers: [Chattaraj et al. 2021](https://elifesciences.org/articles/67176), [Chattaraj & Loew 2023](https://www.cell.com/biophysj/fulltext/S0006-3495(23)00209-6), [Chattaraj et al. 2024](https://www.molbiolcell.org/doi/full/10.1091/mbc.E24-01-0030)

- Data analysis helper: [SpringSaLaDPy](https://github.com/SpringSaLaDpy/SpringSaLaDpy_demo)

  

